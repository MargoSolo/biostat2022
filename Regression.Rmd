---
title: "Regression"
author: "Nadezhda Tsurikova"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

#1

```{r}
library(glmnet)
library(mvtnorm)
library(ggplot2)
library(dplyr)
library(tidyr)
library(faux)
```

моделирую выборку из многомерного нормального распределения

```{r}

df <- rnorm_multi(n = 100, 
                   mu = c(88.5, 5.4),
                   sd = c(13.25, 1.45),
                   r = c(0.6), 
                   varnames = c("k", "m"))

lm1 <- lm(k~m, data=df)

```



```{r}
summary(lm1)
```
F-statistic: 48.44 соответствует p-value 3.892e-10,  p-value меньше 0,05, это означает, что модель является статистически значимой.

Adjusted R-squared:  0.3239 - свидетельствует о том, что 32,3% вариации переменной отклика y можно объяснить переменной-предиктором м(мочевиной).

Коэффициентная оценка м=4.7279б, что говорит о том, что каждое дополнительное увеличение м на одну единицу связано со средним увеличением y на 4.7279б


```{r}
plot(lm1)
```

линия тренда примерно плоская и близка к нулю,  можно предположить, что остатки распределены нормально

#Добавим в модель еще один признак W, добавьте этот признак в вашу модель линейной регрессии
```{r}
w <- rnorm(100)
df$w <- w

lm2 <- lm(k~m+w, data=df)
```


Как изменился коэффициент детерминации
в новой модели? Как изменился модифицированный коэффициент детерминации
```{r}
summary(lm2)
```
Коэффициент детерминации (Multiple R-squared)  и модифицированный коэф.детерминации (Adjusted R-squared) =  0.3348 и 0.3211, соответственно, т.е. остались практически такими же.


```{r}
n=50
x1 <- rnorm(n, mean=1)
x2 <- x1*(1+runif(n, min = 0, max = 0.1))
x3 <- x1+x2+rnorm(n, sd=0.1)
x4 <- x3*(1+runif(n, min = 0, max = 0.1))
x5 <- x3+x2+rnorm(n, sd=0.05)
y <- x1+x2+x3+x4+x5+rnorm(n, sd=0.5)

lm3 <- lm(y~x1+x2+x3+x4+x5)
summary(lm3)
```

```{r}
plot(lm3)
```

```{r}
n=50
a <- matrix(c(x1,x2,x3,x4,x5), ncol = 5)
b <- rnorm(n)
la <- glmnet(a, b, family = "gaussian", intercept = F, alpha = 1, r = 0.2)

matplot(log(la$lambda), t(la$beta),  main="Lasso",lwd = 2, xlim = c(-10, 10))
```

Искренне и очень долго пыталась разобраться почему у меня не работает график, но так  не смогла, при попытке дописать в функцию type=1, у меня выскакивает ошибка.
Нашла такой вариант 

```{r}
predict(la, type = "coefficient", family = "gaussian" , r = 0.2)
plot(la, xvar = "lambda")

```

```{r}

```

